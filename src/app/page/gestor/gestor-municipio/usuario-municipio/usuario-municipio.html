<div class="gestor-container d-flex flex-column align-items-center p-2">
  <div class="card shadow-lg rounded-3 border-0 w-100 gestor-main-card">
    <div class="card-body gestor-main-card-body">
      
      <h2 class="card-title mb-4 fw-bold text-dark text-center gestor-section-title">
        Gestión de Usuarios del Sistema
      </h2>
      
      <!-- Botón para añadir nuevo usuario -->
      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-primary btn-sm rounded-pill shadow-sm gestor-add-btn" (click)="addUsuario()">
          <i class="bi bi-person-plus-fill me-2"></i> Añadir Nuevo Usuario
        </button>
      </div>

      <!-- Sección de usuarios activos -->
      <h3 class="gestor-subsection-title px-4">Usuarios Activos</h3>

      <div *ngIf="!isLoading && usuarios.length > 0"
        class="table-responsive gestor-table-responsive mb-1 p-1">
        <table 
            class="table table-hover table-bordered rounded-3 overflow-hidden shadow-sm align-middle gestor-table">
            <thead class="bg-primary text-white">
                <tr>
                    <th scope="col">Cédula</th>
                    <th scope="col">Nombre Completo</th>
                    <th scope="col">Email</th>
                    <th scope="col">Usuario</th>
                    <th scope="col">Rol Asignado</th>
                    <th scope="col">Estado</th>
                    <th scope="col">Municipio</th>
                    <th scope="col">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let usuario of usuarios">
              <td title="{{ usuario.tipo_cedula }}{{ usuario.cedula }}">{{ usuario.tipo_cedula }}{{ usuario.cedula }}</td>
              <td title="{{ usuario.nombre }} {{ usuario.apellido }}">{{ usuario.nombre }} {{ usuario.apellido }}</td>
              <td title="{{ usuario.correo }}">{{ usuario.correo }}</td>
              <td title="{{ usuario.usuario }}">{{ usuario.usuario }}</td>
              <td title="{{ usuario.descripcion_rol }}">{{ usuario.descripcion_rol }}</td>
              <td title="{{ usuario.nombre_estado_asignado || 'N/A' }}">{{ usuario.nombre_estado_asignado || 'N/A' }}</td>
              <td title="{{ usuario.nombre_municipio_asignado || 'N/A' }}">{{ usuario.nombre_municipio_asignado || 'N/A' }}</td>
              <td class="text-center">
                <button class="btn btn-sm btn-info gestor-btn" (click)="editUsuario(usuario)" title="Editar Usuario">
                  <i class="bi bi-pencil-square"></i>
                </button>
                <button class="btn btn-sm btn-danger gestor-btn" (click)="deleteUsuario(usuario)" title="Eliminar Usuario">
                  <i class="bi bi-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="!isLoading && !errorMessage && usuarios.length === 0"
        class="alert alert-warning text-center rounded-3 shadow-sm my-4">
        No hay usuarios activos registrados en este ámbito.
      </div>
    </div>
  </div>
</div>
